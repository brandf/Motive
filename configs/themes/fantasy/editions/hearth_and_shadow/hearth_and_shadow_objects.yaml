entity_definitions:
  notice_board:
    behaviors:
    - object
    attributes:
      name: Notice Board
      description: A weathered wooden board covered with missing person posters and town announcements.
    properties:
      readable: true
      text: |
        **MISSING PERSONS:**
        • Mayor Thompson - Last seen 3 days ago near the Old Forest Path. Reward: 100 gold coins for information.
        • Sarah Chen's daughter - Missing since the mayor's disappearance. Desperate mother seeking help.
        • Three townsfolk from Market District - Vanished without trace. Pattern suggests cult activity.
        
        **TOWN ANNOUNCEMENTS:**
        • Guard Captain O'Malley requests all citizens report suspicious activities to the bank guard post.
        • Adventurer's Guild offering protection services - contact Guild Master Elena at the tavern.
        • Church services suspended due to "unforeseen circumstances" - Father Marcus unavailable.
        
        **REWARD POSTERS:**
        • Information about cult symbols: 50 gold coins
        • Location of underground tunnels: 75 gold coins
        • Evidence of recent ritual activity: 100 gold coins
    action_aliases:
      read: look
      examine: look
    interactions:
      look:
        effects:
        - type: increment_property
          target: player
          property: evidence_collected
          increment_value: 1
        - type: generate_event
          message: '{{player_name}} examines the notice board and finds important information! Evidence collected: {{player_property:evidence_collected}}/3'
          observers:
          - room_characters
  broken_fountain:
    behaviors:
    - object
    attributes:
      name: Broken Fountain
      description: A once-beautiful stone fountain, now cracked and dry.
    properties:
      immovable: true
      size: large
    action_aliases:
      examine: look
  bar:
    behaviors:
    - object
    attributes:
      name: Bar
      description: A long wooden bar where drinks are served.
    properties:
      immovable: true
      size: large
  quest_board:
    behaviors:
    - object
    attributes:
      name: Quest Board
      description: A board covered with various quests and missions.
    properties:
      readable: true
      text: Various quests and bounties are posted here, including some related to
        recent disappearances.
    action_aliases:
      read: look
      examine: look
  guild_master_desk:
    behaviors:
    - object
    attributes:
      name: Guild Master's Desk
      description: A massive oak desk covered with reports and correspondence.
    properties:
      immovable: true
      size: large
      readable: true
      text: The desk contains various reports and maps that might contain valuable
        information.
    action_aliases:
      investigate: look
      examine: look
      read: look
  weapon_rack:
    behaviors:
    - object
    attributes:
      name: Weapon Rack
      description: A rack displaying various weapons and armor.
    properties:
      immovable: true
      size: large
    action_aliases:
      examine: look
  stolen_goods:
    behaviors:
    - object
    attributes:
      name: Stolen Goods
      description: Various stolen items and contraband.
    properties:
      immovable: true
      size: medium
  secret_documents:
    behaviors:
    - object
    attributes:
      name: Secret Documents
      description: A collection of documents that might contain valuable information.
    properties:
      readable: true
      text: These documents contain information about the town's troubles and recent
        activities.
    action_aliases:
      read: look
      examine: look
  raven_chair:
    behaviors:
    - object
    attributes:
      name: The Raven's Chair
      description: A high-backed chair where the leader of the thieves' guild sits.
    properties:
      immovable: true
      size: large
  confession_booth:
    behaviors:
    - object
    attributes:
      name: Confession Booth
      description: A wooden booth where the faithful come to confess their sins.
    properties:
      immovable: true
      size: medium
  crypt_entrance:
    behaviors:
    - object
    attributes:
      name: Crypt Entrance
      description: A hidden entrance to the underground crypt.
    properties:
      immovable: true
      size: medium
  mausoleum:
    behaviors:
    - object
    attributes:
      name: Mausoleum
      description: A large stone mausoleum with doors that seem to be slightly ajar.
    properties:
      immovable: true
      size: huge
  fresh_graves:
    behaviors:
    - object
    attributes:
      name: Fresh Graves
      description: Several graves that appear to have been recently dug.
    properties:
      immovable: true
      size: large
  suspicious_footprints:
    behaviors:
    - object
    attributes:
      name: Suspicious Footprints
      description: Footprints in the soft earth that don't seem to belong to any normal
        visitor.
    properties:
      immovable: true
      size: small
  vault:
    behaviors:
    - object
    attributes:
      name: Vault
      description: A massive steel vault that seems to be open more often than it
        should be.
    properties:
      immovable: true
      size: huge
  ledgers:
    behaviors:
    - object
    attributes:
      name: Bank Ledgers
      description: Financial records that might contain clues about mysterious transactions.
    properties:
      readable: true
      text: These ledgers contain financial records that might reveal clues about
        the mysterious withdrawals.
    action_aliases:
      read: look
      investigate: look
  guard_post:
    behaviors:
    - object
    attributes:
      name: Guard Post
      description: A security station that seems to be unmanned more often than not.
    properties:
      immovable: true
      size: medium
  merchant_stalls:
    behaviors:
    - object
    attributes:
      name: Merchant Stalls
      description: Various stalls where merchants sell their wares.
    properties:
      immovable: true
      size: large
  hidden_alleyways:
    behaviors:
    - object
    attributes:
      name: Hidden Alleyways
      description: Narrow passages between buildings that lead to secret meeting places.
    properties:
      immovable: true
      size: medium
  cult_symbols:
    behaviors:
    - object
    attributes:
      name: Cult Symbols
      description: Dark, unsettling symbols painted on walls and carved into surfaces.
    properties:
      readable: true
      immovable: true
      size: small
      text: The symbols seem to pulse with dark energy. They appear to be some form
        of ancient writing, but the meaning is unclear. However, they all seem to
        point toward the same direction - deeper into the underground.
    action_aliases:
      read: look
      examine: look
      investigate: look
  evidence_activity:
    behaviors:
    - object
    attributes:
      name: Evidence of Recent Activity
      description: Signs that someone has been using these tunnels recently.
    properties:
      immovable: true
      size: small
  secret_doors:
    behaviors:
    - object
    attributes:
      name: Secret Doors
      description: Hidden entrances and exits that lead to various parts of the town.
    properties:
      immovable: true
      size: medium
  cult_altar:
    behaviors:
    - object
    attributes:
      name: Cult Altar
      description: A dark altar covered with cult artifacts and evidence of recent
        rituals.
    properties:
      immovable: true
      size: large
  prisoner_cells:
    behaviors:
    - object
    attributes:
      name: Prisoner Cells
      description: Cells where the cult keeps their prisoners.
    properties:
      immovable: true
      size: large
  cult_artifacts:
    behaviors:
    - object
    attributes:
      name: Cult Artifacts
      description: Various dark objects and artifacts used in the cult's rituals.
    properties:
      immovable: true
      size: medium
  mayors_journal:
    behaviors:
    - object
    attributes:
      name: Mayor's Journal
      description: A leather-bound journal belonging to the missing mayor, filled
        with his private thoughts and observations.
    properties:
      readable: true
      pickupable: true
      size: small
    action_aliases:
      read: look
      investigate: look
      examine: look
    text: The cult's influence grows stronger each day. I fear they have infiltrated
      the town guard. Father Marcus seems troubled - I must speak with him. The
      disappearances are not random - they're targeting specific people. I've hidden
      evidence in the bank vault. If something happens to me, find Detective Thorne.
  cult_ritual_book:
    behaviors:
    - object
    attributes:
      name: Cult Ritual Book
      description: A dark, leather-bound tome filled with ancient symbols and blood-stained pages.
    properties:
      readable: true
      pickupable: true
      size: medium
      pages_read: { type: number, default: 0 }
      ritual_understood: { type: boolean, default: false }
      cult_members_identified: { type: boolean, default: false }
      ritual_timing_known: { type: boolean, default: false }
      dark_magic_exposure: { type: number, default: 0 }
      text: 'The Shadowed Hand seeks to summon the Dark Lord through blood sacrifice. The ritual requires seven pure souls, taken during the new moon. The mayor was the first - his blood opened the gateway. The next six must be taken in sequence: the priest, the warrior, the merchant, the child, the innocent, and the betrayer.'
    computed:
      knowledge_level:
        type: number
        expr: "pages_read + (ritual_understood ? 2 : 0) + (cult_members_identified ? 2 : 0) + (ritual_timing_known ? 2 : 0)"
      corruption_risk:
        type: number
        expr: "dark_magic_exposure + (pages_read * 0.5)"
    affordances:
      - action: read_carefully
        requires:
          expr: "prop.pages_read < 5"
        effects:
          - increment_property: { selector: this, key: pages_read, increment_value: 1 }
          - increment_property: { selector: this, key: dark_magic_exposure, increment_value: 1 }
          - emit_event:
              scope: room_characters
              message: "{{player_name}} reads more of the cult ritual book, learning about their dark plans."
      - action: study_ritual
        requires:
          expr: "prop.pages_read >= 3 && prop.ritual_understood == false"
        effects:
          - set_property: { selector: this, key: ritual_understood, value: true }
          - increment_property: { selector: this, key: dark_magic_exposure, increment_value: 2 }
          - emit_event:
              scope: room_characters
              message: "{{player_name}} studies the ritual details and understands the cult's true plan!"
      - action: identify_members
        requires:
          expr: "prop.pages_read >= 4 && prop.cult_members_identified == false"
        effects:
          - set_property: { selector: this, key: cult_members_identified, value: true }
          - increment_property: { selector: this, key: dark_magic_exposure, increment_value: 1 }
          - emit_event:
              scope: room_characters
              message: "{{player_name}} identifies the cult members mentioned in the book!"
      - action: learn_timing
        requires:
          expr: "prop.pages_read >= 5 && prop.ritual_timing_known == false"
        effects:
          - set_property: { selector: this, key: ritual_timing_known, value: true }
          - increment_property: { selector: this, key: dark_magic_exposure, increment_value: 1 }
          - emit_event:
              scope: room_characters
              message: "{{player_name}} learns the exact timing of the cult's ritual!"
    triggers:
      - when: "ritual_understood == true"
        then:
          - emit_event:
              scope: room_characters
              message: "Detective James now understands the cult's ritual and can work to prevent it!"
          - increment_property: { selector: player, key: evidence_collected, increment_value: 1 }
      - when: "cult_members_identified == true"
        then:
          - emit_event:
              scope: room_characters
              message: "Detective James has identified the cult members and can expose them!"
          - increment_property: { selector: player, key: evidence_collected, increment_value: 1 }
      - when: "ritual_timing_known == true"
        then:
          - emit_event:
              scope: room_characters
              message: "Detective James knows when the cult will strike and can prepare accordingly!"
          - increment_property: { selector: player, key: evidence_collected, increment_value: 1 }
      - when: "corruption_risk > 5"
        then:
          - emit_event:
              scope: room_characters
              message: "Detective James is feeling the corrupting influence of the dark magic in the book."
          - increment_property: { selector: player, key: cult_corruption, increment_value: 1 }
  missing_persons_effects:
    behaviors:
    - object
    attributes:
      name: Personal Effects
      description: A collection of personal items belonging to the missing townsfolk.
    properties:
      readable: true
      pickupable: true
      size: small
      text: Letters, jewelry, and small trinkets. Each item tells a story of a life
        interrupted. A child's doll, a wedding ring, a merchant's ledger. All taken
        from their owners before they disappeared.
  cult_members_confession:
    behaviors:
    - object
    attributes:
      name: Cult Member's Confession
      description: A handwritten confession found in the church records.
    properties:
      readable: true
      pickupable: true
      size: small
      text: I was forced to join the Shadowed Hand. They threatened my family. The
        cult is planning something big - a ritual that will change everything. They
        have people in high places. I can't say more, but the mayor knows too much.
        They're coming for him next.
  fresh_evidence:
    behaviors:
    - object
    attributes:
      name: Fresh Evidence
      description: A disturbed patch of earth near the fountain with strange markings and bloodstains.
    properties:
      readable: true
      pickupable: true
      size: medium
      examined: { type: boolean, default: false }
      investigation_level: { type: number, default: 0 }
      blood_analyzed: { type: boolean, default: false }
      symbols_decoded: { type: boolean, default: false }
      footprints_traced: { type: boolean, default: false }
      text: |
        **CRIME SCENE EVIDENCE:**
        The earth has been recently disturbed in a circular pattern. Strange symbols are carved into the ground, still wet with what appears to be blood. The symbols appear to be some form of ritual marking.
        
        **FOOTPRINTS:** Multiple sets of footprints lead away from the site toward the Old Forest Path. The prints suggest 2-3 people were here recently, and one set appears to be dragging something heavy.
        
        **BLOOD ANALYSIS:** The blood appears fresh (less than 24 hours old) and there's enough to suggest serious injury or worse.
        
        **RITUAL SYMBOLS:** The carved symbols match patterns seen in other parts of town, suggesting this is part of a larger cult ritual.
    computed:
      investigation_complete:
        type: boolean
        expr: "blood_analyzed && symbols_decoded && footprints_traced"
      evidence_value:
        type: number
        expr: "investigation_level * 10"
    action_aliases:
      investigate: look
      examine: look
      read: look
      analyze: use
      decode: use
      trace: use
    affordances:
      - action: investigate
        requires:
          expr: "prop.examined == false"
        effects:
          - set_property: { selector: this, key: examined, value: true }
          - increment_property: { selector: this, key: investigation_level, increment_value: 1 }
          - emit_event:
              scope: room_characters
              message: "{{player_name}} begins investigating the crime scene evidence."
      - action: analyze_blood
        requires:
          expr: "prop.examined == true && prop.blood_analyzed == false"
        effects:
          - set_property: { selector: this, key: blood_analyzed, value: true }
          - increment_property: { selector: this, key: investigation_level, increment_value: 1 }
          - emit_event:
              scope: room_characters
              message: "{{player_name}} analyzes the blood samples and discovers they belong to the mayor!"
      - action: decode_symbols
        requires:
          expr: "prop.examined == true && prop.symbols_decoded == false"
        effects:
          - set_property: { selector: this, key: symbols_decoded, value: true }
          - increment_property: { selector: this, key: investigation_level, increment_value: 1 }
          - emit_event:
              scope: room_characters
              message: "{{player_name}} decodes the ritual symbols and learns they point to the underground chambers!"
      - action: trace_footprints
        requires:
          expr: "prop.examined == true && prop.footprints_traced == false"
        effects:
          - set_property: { selector: this, key: footprints_traced, value: true }
          - increment_property: { selector: this, key: investigation_level, increment_value: 1 }
          - emit_event:
              scope: room_characters
              message: "{{player_name}} traces the footprints and discovers they lead to the Old Forest Path!"
    triggers:
      - when: "investigation_complete == true"
        then:
          - emit_event:
              scope: room_characters
              message: "Detective James has completed a thorough investigation of the crime scene evidence!"
          - increment_property: { selector: player, key: evidence_collected, increment_value: 1 }
  suspicious_sounds:
    behaviors:
    - object
    attributes:
      name: Suspicious Sounds
      description: Strange noises coming from underground.
    properties:
      readable: true
      immovable: true
      size: small
      text: Low, chanting voices echo from below. The sound is muffled but unmistakable
        - someone is performing a ritual. The voices seem to be getting louder, more
        urgent.
  missing_items:
    behaviors:
    - object
    attributes:
      name: Missing Items
      description: Items that were clearly taken, not lost.
    properties:
      readable: true
      immovable: true
      size: small
      text: Empty spaces where items once sat. Dust outlines show where objects were
        recently removed. The pattern suggests a systematic search - someone was looking
        for something specific.
  witnessed_abduction:
    behaviors:
    - object
    attributes:
      name: Witnessed Abduction
      description: Evidence of a recent abduction.
    properties:
      readable: true
      immovable: true
      size: medium
      text: Struggle marks on the ground, a torn piece of clothing, and a single drop
        of blood. Someone was taken by force, and recently. The trail leads toward
        the underground tunnels.
  lockpicks:
    behaviors:
    - object
    attributes:
      name: Lockpicks
      description: A set of fine metal tools for opening locks.
    properties:
      pickupable: true
      size: small
      tool_type: lockpicking
  torch:
    behaviors:
    - object
    attributes:
      name: Torch
      description: A wooden torch that can be lit to provide light in dark areas.
    properties:
      pickupable: true
      size: medium
      tool_type: lighting
      fuel: 100
      is_lit: false
      interactions:
        use:
        - type: set_property
          property: is_lit
          toggle: true
        - type: generate_event
          message: '{player_name} uses {object_name}.'
          observers:
          - room_characters
  rope:
    behaviors:
    - object
    attributes:
      name: Rope
      description: A sturdy length of rope, useful for climbing or binding.
    properties:
      pickupable: true
      size: medium
      tool_type: climbing
  investigation_kit:
    behaviors:
    - object
    attributes:
      name: Investigation Kit
      description: A small kit containing magnifying glass, tweezers, and evidence bags.
    properties:
      pickupable: true
      size: small
      tool_type: investigation
      uses_remaining: { type: number, default: 10 }
      blood_analysis_enabled: { type: boolean, default: true }
      fingerprint_analysis_enabled: { type: boolean, default: true }
      evidence_collection_enabled: { type: boolean, default: true }
    computed:
      is_functional:
        type: boolean
        expr: "uses_remaining > 0"
      analysis_capabilities:
        type: number
        expr: "(blood_analysis_enabled ? 1 : 0) + (fingerprint_analysis_enabled ? 1 : 0) + (evidence_collection_enabled ? 1 : 0)"
    affordances:
      - action: analyze_blood
        requires:
          expr: "prop.is_functional == true && prop.blood_analysis_enabled == true"
        effects:
          - increment_property: { selector: this, key: uses_remaining, increment_value: -1 }
          - emit_event:
              scope: room_characters
              message: "{{player_name}} uses the investigation kit to analyze blood samples."
      - action: collect_fingerprints
        requires:
          expr: "prop.is_functional == true && prop.fingerprint_analysis_enabled == true"
        effects:
          - increment_property: { selector: this, key: uses_remaining, increment_value: -1 }
          - emit_event:
              scope: room_characters
              message: "{{player_name}} uses the investigation kit to collect fingerprint evidence."
      - action: collect_evidence
        requires:
          expr: "prop.is_functional == true && prop.evidence_collection_enabled == true"
        effects:
          - increment_property: { selector: this, key: uses_remaining, increment_value: -1 }
          - emit_event:
              scope: room_characters
              message: "{{player_name}} uses the investigation kit to collect physical evidence."
    triggers:
      - when: "uses_remaining <= 0"
        then:
          - emit_event:
              scope: room_characters
              message: "The investigation kit has run out of supplies and is no longer functional."
  crowbar:
    behaviors:
    - object
    attributes:
      name: Crowbar
      description: A heavy metal bar useful for prying open doors and crates.
    properties:
      pickupable: true
      size: medium
      tool_type: prying
  holy_water:
    behaviors:
    - object
    attributes:
      name: Holy Water
      description: A small vial of blessed water from the church.
    properties:
      pickupable: true
      size: small
      tool_type: spiritual
      blessed: true
  eternal_flame:
    behaviors:
    - object
    attributes:
      name: Eternal Flame
      description: A small, magical flame that never goes out, symbolizing the town's
        unbreakable spirit.
    properties:
      immovable: true
      size: small
      magical: true
      hearth_symbol: true
  shadow_crystal:
    behaviors:
    - object
    attributes:
      name: Shadow Crystal
      description: A dark crystal that seems to absorb light and warmth, pulsing with
        malevolent energy.
    properties:
      pickupable: true
      size: small
      magical: true
      shadow_symbol: true
  hearth_stone:
    behaviors:
    - object
    attributes:
      name: Hearth Stone
      description: A warm stone that radiates comfort and hope, said to protect against
        dark magic.
    properties:
      pickupable: true
      size: small
      magical: true
      hearth_symbol: true
  shadow_mirror:
    behaviors:
    - object
    attributes:
      name: Shadow Mirror
      description: A dark mirror that shows not your reflection, but the shadows of
        your fears and doubts.
    properties:
      immovable: true
      size: medium
      magical: true
      shadow_symbol: true
  flame_of_hope:
    behaviors:
    - object
    attributes:
      name: Flame of Hope
      description: A small, flickering flame that grows brighter when hope is strong
        and dims when despair takes hold.
    properties:
      immovable: true
      size: small
      magical: true
      hearth_symbol: true
      responsive: true
  message_board:
    behaviors:
    - object
    attributes:
      name: Message Board
      description: A wooden board where characters can leave messages for each other.
    properties:
      readable: true
      writable: true
      immovable: true
      size: medium
      communication: true
  secret_drop_point:
    behaviors:
    - object
    attributes:
      name: Secret Drop Point
      description: A hidden location where anonymous messages can be left and retrieved.
    properties:
      readable: true
      writable: true
      immovable: true
      size: small
      hidden: true
      communication: true
  pigeon_coop:
    behaviors:
    - object
    attributes:
      name: Pigeon Coop
      description: A small coop where carrier pigeons can be used to send private
        messages.
    properties:
      readable: true
      writable: true
      immovable: true
      size: medium
      communication: true
      private: true
  burning_candle:
    behaviors:
    - object
    attributes:
      name: Burning Candle
      description: A candle that burns down over time, creating urgency.
    properties:
      immovable: true
      size: small
      time_sensitive: true
      fuel: 100
  fresh_footprints:
    behaviors:
    - object
    attributes:
      name: Fresh Footprints
      description: Footprints that will disappear as time passes.
    properties:
      readable: true
      immovable: true
      size: small
      time_sensitive: true
      text: Fresh footprints in the dust. They appear to be recent and will fade soon.
  disturbed_earth:
    behaviors:
    - object
    attributes:
      name: Disturbed Earth
      description: Recently disturbed earth that will settle over time.
    properties:
      readable: true
      immovable: true
      size: medium
      time_sensitive: true
      text: The earth has been recently disturbed. It will settle and become less
        obvious over time.
  ritual_preparations:
    behaviors:
    - object
    attributes:
      name: Ritual Preparations
      description: Evidence of ongoing ritual preparations that will be completed
        soon.
    properties:
      readable: true
      immovable: true
      size: medium
      time_sensitive: true
      text: The cult is preparing for a major ritual. The preparations will be complete
        soon.
  detectives_notebook:
    behaviors:
    - object
    attributes:
      name: Detective's Notebook
      description: A worn leather notebook filled with clues, suspects, and case notes.
    properties:
      readable: true
      pickupable: true
      size: small
      character_specific: detective_james
      text: Case notes on the Blackwater disappearances. Contains sketches of suspects
        and evidence.
  daughters_medicine:
    behaviors:
    - object
    attributes:
      name: Daughter's Medicine
      description: Expensive medicine needed for Detective James's sick daughter.
    properties:
      pickupable: true
      size: small
      character_specific: detective_james
      valuable: true
  confession_notes:
    behaviors:
    - object
    attributes:
      name: Confession Notes
      description: Secret notes about the cult's activities that Father Marcus has
        been keeping.
    properties:
      readable: true
      pickupable: true
      size: small
      character_specific: father_marcus
      text: Detailed notes about the cult's rituals and plans. Very dangerous if discovered.
  protection_money:
    behaviors:
    - object
    attributes:
      name: Protection Money
      description: Gold coins that Gareth has been paying to The Raven for protection.
    properties:
      pickupable: true
      size: small
      character_specific: gareth
      valuable: true
  cult_escape_kit:
    behaviors:
    - object
    attributes:
      name: Cult Escape Kit
      description: A small kit with tools for escaping the cult's clutches.
    properties:
      pickupable: true
      size: small
      character_specific: sarah
      survival: true
  ancient_artifacts:
    behaviors:
    - object
    attributes:
      name: Ancient Artifacts
      description: Mysterious artifacts that Valdris carries with him.
    properties:
      pickupable: true
      size: small
      character_specific: valdris
      magical: true
  town_treasury:
    behaviors:
    - object
    attributes:
      name: Town Treasury
      description: The town's financial resources, controlled by the bank manager.
    properties:
      immovable: true
      size: large
      resource: money
      amount: 1000
  guild_resources:
    behaviors:
    - object
    attributes:
      name: Guild Resources
      description: Weapons, armor, and supplies controlled by the guild master.
    properties:
      immovable: true
      size: large
      resource: equipment
      amount: 50
  information_network:
    behaviors:
    - object
    attributes:
      name: Information Network
      description: The barkeep's network of informants and contacts.
    properties:
      immovable: true
      size: medium
      resource: information
      reach: town_wide
  underground_network:
    behaviors:
    - object
    attributes:
      name: Underground Network
      description: The Raven's criminal network and safe houses.
    properties:
      immovable: true
      size: medium
      resource: security
      reach: regional
